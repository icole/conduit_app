<div class="container mx-auto max-w-6xl px-4 py-8">
  <!-- Header -->
  <div class="flex justify-between items-center mb-6">
    <div>
      <h1 class="text-2xl font-bold">Meal Calendar</h1>
      <p class="text-base-content/70 mt-1"><%= @start_of_month.strftime("%B %Y") %></p>
    </div>
    <div class="flex gap-2">
      <%= link_to meals_path, class: "btn btn-outline" do %>
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/>
        </svg>
        List View
      <% end %>
    </div>
  </div>

  <!-- Month Navigation -->
  <div class="flex justify-center gap-4 mb-6">
    <%= link_to calendar_meals_path(date: @start_of_month - 1.month), class: "btn btn-ghost btn-sm" do %>
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
      Previous
    <% end %>
    <%= link_to calendar_meals_path, class: "btn btn-ghost btn-sm" do %>
      Today
    <% end %>
    <%= link_to calendar_meals_path(date: @start_of_month + 1.month), class: "btn btn-ghost btn-sm" do %>
      Next
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
      </svg>
    <% end %>
  </div>

  <!-- Calendar Grid -->
  <div class="grid grid-cols-7 gap-1">
    <!-- Day Headers -->
    <% %w[Mon Tue Wed Thu Fri Sat Sun].each do |day| %>
      <div class="text-center font-medium text-sm text-base-content/70 py-2 bg-base-200 rounded">
        <%= day %>
      </div>
    <% end %>

    <!-- Day Cells -->
    <% (@calendar_start..@calendar_end).each do |date| %>
      <% is_today = date == Date.current %>
      <% is_current_month = date.month == @start_of_month.month %>
      <% day_meals = @meals_by_date[date] || [] %>

      <div class="min-h-24 p-1 rounded-lg border <%= is_today ? 'bg-primary/10 border-primary border-2' : (is_current_month ? 'bg-base-100 border-base-300' : 'bg-base-200/50 border-base-300') %>">
        <div class="text-xs font-medium <%= is_today ? 'text-primary' : (is_current_month ? 'text-base-content' : 'text-base-content/40') %> mb-1 px-1">
          <%= date.day %>
        </div>

        <div class="space-y-0.5 overflow-y-auto max-h-20">
          <% day_meals.each do |meal| %>
            <%= link_to meal_path(meal), class: "block p-1 rounded bg-#{is_current_month ? 'base-200' : 'base-300/50'} hover:bg-base-300 transition-colors text-xs" do %>
              <div class="font-medium truncate <%= is_current_month ? '' : 'text-base-content/50' %>"><%= meal.title %></div>
              <% if meal.needs_head_cook? %>
                <div class="badge badge-warning badge-xs">Needs cook</div>
              <% end %>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
