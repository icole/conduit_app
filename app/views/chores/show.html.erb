<div class="container mx-auto px-4 py-8">
  <div class="max-w-4xl mx-auto">
    <!-- Header Section -->
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-2xl font-bold"><%= @chore.name %></h1>
      <div class="flex gap-2">
        <%= link_to chores_path, class: "btn btn-outline btn-sm" do %>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"/>
          </svg>
          Back to Chores
        <% end %>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Main Content -->
      <div class="lg:col-span-2 space-y-6">
        <!-- Chore Details -->
        <div class="card bg-base-100 shadow-sm">
          <div class="card-body">
            <div class="flex items-center gap-2 mb-4">
              <span class="badge badge-<%= @chore.proposed? ? 'ghost' : (@chore.active? ? 'success' : 'neutral') %>">
                <%= @chore.status.humanize %>
              </span>
              <% if @chore.frequency.present? %>
                <span class="badge badge-outline"><%= @chore.frequency.humanize %></span>
              <% else %>
                <span class="badge badge-outline">Frequency TBD</span>
              <% end %>
            </div>

            <% if @chore.description.present? %>
              <div class="prose prose-sm max-w-none mb-4">
                <p><%= simple_format(@chore.description) %></p>
              </div>
            <% end %>

            <div class="text-sm text-base-content/70 mb-4">
              Proposed by <strong><%= @chore.proposed_by.name %></strong> on <%= @chore.created_at.strftime("%B %d, %Y") %>
            </div>

            <!-- Actions for Proposed Chores -->
            <% if @chore.proposed? %>
              <div class="flex items-center gap-4">
                <%= render 'shared/like_button', likeable: @chore, style: :topic %>
                <% if current_user.admin? %>
                  <%= button_to approve_chore_path(@chore), method: :post, 
                      class: "btn btn-primary btn-sm",
                      data: { confirm: "Approve this chore and make it active?" } do %>
                    Approve Chore
                  <% end %>
                <% end %>
              </div>
            <% end %>

            <!-- Actions for Active Chores -->
            <% if @chore.active? %>
              <div class="flex flex-wrap gap-2">
                <% if @chore.assigned_to?(current_user) %>
                  <%= button_to complete_chore_path(@chore), method: :post, 
                      class: "btn btn-success btn-sm",
                      data: { confirm: "Mark this chore as complete?" } do %>
                    Mark Complete
                  <% end %>
                <% elsif @chore.needs_volunteer? %>
                  <%= button_to volunteer_chore_path(@chore), method: :post, 
                      class: "btn btn-primary btn-sm",
                      data: { confirm: "Volunteer for this chore?" } do %>
                    Volunteer
                  <% end %>
                <% end %>
              </div>
            <% end %>
          </div>
        </div>

        <!-- Comments Section -->

      </div>

      <!-- Sidebar -->
      <div class="space-y-4">
        <!-- Assignment Info -->
        <% if @chore.active? %>
          <div class="card bg-base-100 shadow-sm">
            <div class="card-body">
              <h3 class="card-title text-lg">Assignment</h3>
              <% if @current_assignment %>
                <div class="flex items-center gap-2">
                  <div class="avatar placeholder">
                    <div class="bg-primary text-primary-content w-10 h-10 rounded-full">
                      <span class="text-sm"><%= @current_assignment.user.name.first(2).upcase %></span>
                    </div>
                  </div>
                  <div>
                    <div class="font-medium"><%= @current_assignment.user.name %></div>
                    <div class="text-sm text-base-content/70">
                      Since <%= @current_assignment.start_date.strftime("%b %d") %>
                    </div>
                  </div>
                </div>
              <% else %>
                <div class="text-center p-4 text-warning">
                  <div class="text-2xl mb-2">⚠️</div>
                  <p class="font-medium">No one assigned</p>
                  <p class="text-sm text-base-content/70">This chore needs a volunteer</p>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>

        <!-- Schedule Info -->
        <% if @chore.active? && @chore.next_due_date %>
          <div class="card bg-base-100 shadow-sm">
            <div class="card-body">
              <h3 class="card-title text-lg">Schedule</h3>
              <div class="space-y-2">
                <div class="flex justify-between">
                  <span class="text-base-content/70">Frequency:</span>
                  <span><%= @chore.frequency&.humanize || "TBD" %></span>
                </div>
                <div class="flex justify-between">
                  <span class="text-base-content/70">Next Due:</span>
                  <span class="<%= @chore.next_due_date < Date.current ? 'text-error' : (@chore.next_due_date == Date.current ? 'text-warning' : '') %>">
                    <%= @chore.next_due_date.strftime("%b %d, %Y") %>
                  </span>
                </div>
              </div>
            </div>
          </div>
        <% end %>

        <!-- Recent Completions -->
        <% if @chore_completions.any? %>
          <div class="card bg-base-100 shadow-sm">
            <div class="card-body">
              <h3 class="card-title text-lg">Recent Completions</h3>
              <div class="space-y-2">
                <% @chore_completions.each do |completion| %>
                  <div class="flex items-center gap-2 text-sm">
                    <div class="avatar placeholder">
                      <div class="bg-success text-success-content w-6 h-6 rounded-full">
                        <span class="text-xs">✓</span>
                      </div>
                    </div>
                    <div>
                      <span class="font-medium"><%= completion.completed_by.name %></span>
                      <span class="text-base-content/60">- <%= completion.completed_at.strftime("%b %d") %></span>
                    </div>
                  </div>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>